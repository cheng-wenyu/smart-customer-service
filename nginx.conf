events {
    worker_connections 1024;
}
http {
    upstream backend {
        server app:8000;
    }

    server {
        listen 80;

        # 规则1：首先尝试提供 static/ 目录下的静态文件（如 index.html, js, css）
        location / {
            root /usr/share/nginx/html;
            try_files $uri $uri/ /index.html;
            # 含义：先找请求的文件，再找同名目录，最后回退到 index.html
        }

        # 规则2：将以 /api/ 开头的请求代理给后端API
        location /api/ {
            proxy_pass http://backend;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
        }

        # 规则3（可选）：如果你希望直接访问后端的 /docs 页面，也可以代理
        location /ask {
            proxy_pass http://backend;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
        }
        location /docs {
            proxy_pass http://backend;
        }
        # 同样可以添加 /redoc 等路径
    }
}
